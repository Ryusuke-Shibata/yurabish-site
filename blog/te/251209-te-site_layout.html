<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>共通部分のコンポーネント化 | Sairy Hub</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>

<body>
  <!-- 共通ヘッダー -->
  <div data-include="/components/header.html"></div>

  <!-- 記事本体 -->
  <main class="blog-post">
    <article>
      <header class="post-header">
        <h1 class="post-title">共通部分のコンポーネント化</h1>
        <div class="post-meta">
          <time datetime="2025-11-03">2025年12月9日</time>
          <span class="category">技術</span>
        </div>
      </header>

      <section class="post-content">
        <p>
          こんにちは、Bindです。<br>
          さて、サイトも無事公開されたわけですが、おおよそ1か月が経ってしまいましたね。<br>
          サイト公開したときの備忘はこちら→<a href = "https://yurabish.com/blog/te/251112-te-site_open">個人サイト開設までの道のり</a><br>
          いろいろと記事は書きつつ、レイアウトも少しばかりいじってみようと奮闘していました。<br>
          ということでそのあたりの備忘です。<br>
        </p>

        <h2>ヘッダー・フッターのコンポーネント化</h2>
        <p>
          ヘッダーとフッターはいずれもサイト内すべてのページで共通です。<br>
          まず一番初めは各ページに直接記載していたのですが、それだと更新するときにとんでもない目に遭うことになります。<br>
          ということでそれぞれコンポーネントとして、各ページではそれを参照する形にテンプレートを修正しました。<br>
          具体的な手順はこんな感じです。<br>
          <h3>コンポーネントの作成</h3>
          とにもかくにもまずコンポーネントそのものの作成です。<br>
          ヘッダーはこのサイトの上にある、ホームとかブログ一覧に飛べるようになっているあれです。<br>
          フッターは一番下の「© Yurabish — 2025」です、生意気にもコピーライトを付けました。<br>
          何事も形からです。<br>
          フッターはともかく、ヘッダーもかなりシンプルにしてます。<br>
          あれこれ凝らずに簡単なものをまず実装してみました。<br>
          <h3>HTMLのインクルード</h3>
          さて、部品ができた後はそれを表示しないといけませんね。<br>
          インクルードという言葉自体は「別のファイルをあるファイルに組み込むこと」を意味します。<br>
          Webページにおいては共通部分をインクルードすることで保守性の向上が狙えます。<br>
          インクルード化さえ実現していれば修正箇所は組み込むコンポーネントのみでよいわけです。<br>
          <br>
          では本題へ、どうやってインクルードするのかという話をしましょう。<br>
          インクルードにはJavaScriptを使用します。<br>
          （調べたところPHPやSSIでも可能みたいですが今回はJavaScriptで実装しました。）<br>
          JavaScriptとはスクリプト言語で、今回で言うと動的なコンテンツの表示に利用します。<br>
          <br>
          実際のコードはこんな感じです。<br>
          【JavaScript】<br>
          <pre><code>
            async function includeParts() {<br>
              const targets = document.querySelectorAll("[data-include]");<br>
              for (const el of targets) {<br>
                const url = el.getAttribute("data-include");<br>
                try {<br>
                  const html = await (await fetch(url)).text();<br>
                  el.outerHTML = html;<br>
                } catch {<br>
                  el.outerHTML = `<div>読み込み失敗: ${url}</div>`;<br>
                }<br>
              }<br>
            }<br>
            <br>
            document.addEventListener("DOMContentLoaded", includeParts);
          </code></pre><br>
          要点だけ整理すると、<br>
          querySelectorAll("[data-include]")：読み込み対象のコンポーネントを探す<br>
          fetch(url)：読み込み対象のコンポーネントの内容を取得<br>
          el.outerHTML = html：元のタグを置き換え<br>
          となります。<br>
          つまり、HTML側で<code><header data-include="./components/header.html"></header></code>のように記載すると、<br>
          外部HTMLの「./components/header.html」が読み込み対象のコンポーネントとして探し出され、<br>
          fetch()で内容が取得され、最終的には元のタグごと置き換えらえる、といった動きになるようです。<br>
          動きだけ見るとシンプルなんですけどね、コードとして記述すると難しいことをやっているみたいですね。<br>
          で、ページ内で<code><script src = "~~.js"></script></code>のように記述して作ったJavaScriptファイルを外部ファイルとして呼び出せば、<br>
          上のほうに書いたコードが動作するというわけですね、たぶん。<br>
          ここは正直なところ理解しきれていません、いったんおまじない的なものとして理解しておこうと思います。<br>          
        </p>

        <h2>最後に</h2>
        <p>
          ということで、今回はページの共通部分のコンポーネント化を実装しました。<br>
          作りつつの勉強なので、なかなか順序良く理解して次！　という進め方ではなく、<br>
          「とりあえずこうすればなんか動くんだな」くらいの理解で進めています。<br>
          そのうち腰を据えて勉強しないと理解が追い付かないタイミングも来るでしょう。<br>
          今回もふわっとした理解まででとどめていますが、いつかちゃんと理解したいと思ってます。<br>
          <br>
          次はMarkdownの実装ですかね、何となく聞いたことはありますが、ページの編集が簡単になるようなので。<br>
          それでは読んでいただいてありがとうございました。<br>
          次回もどうぞよろしくお願いします。<br>
        </p>
      </section>

      <footer class="post-footer">
        <p>タグ: <span class="tag">Web開発</span> <span class="tag">HTML</span></p>
      </footer>
    </article>
  </main>

  <!-- 共通フッター -->
  <div data-include="/components/footer.html"></div>

  <!-- header.htmlの読み込み -->
  <script src = "js/include.js"></script>

  <!-- JSが無効な場合 -->
  <noscript>
    <div style="background: #ffcccc; color: #000; padding: 1em; text-align: center;">
      JavaScriptが無効になっています。このサイトの一部機能が動作しない場合があります。
    </div>
  </noscript>
</body>
</html>
